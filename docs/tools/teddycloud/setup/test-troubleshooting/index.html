<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This site shows how to test if teddyCloud is running fine and shows steps to solve occuring problems."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:title" content="Test & Troubleshooting"><meta property="og:description" content="This site shows how to test if teddyCloud is running fine and shows steps to solve occuring problems."><meta property="og:type" content="article"><meta property="og:url" content="https://tonies-wiki.revvox.de/docs/tools/teddycloud/setup/test-troubleshooting/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2024-10-10T20:56:31+02:00"><title>Test & Troubleshooting | Toniebox Hacking</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=stylesheet href=/book.min.e2994ec3dc0cc7d1d85b138ad4e4c3f02d8abfa8b8471dfe0ab15a7a8a77d6ee.css integrity="sha256-4plOw9wMx9HYWxOK1OTD8C2Kv6i4Rx3+CrFaeop31u4=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.8414885d4625632152258896ac1ed986b6bd86e12d3d8dc605bca97dbc2a3e37.js integrity="sha256-hBSIXUYlYyFSJYiWrB7Zhra9huEtPY3GBbypfbwqPjc=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Toniebox Hacking</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</a></label><ul></ul></li></ul><ul><li><a href=/docs/how-to-get-started/>How to get started?</a><ul></ul></li><li><a href=/docs/rules/>Community Guidelines</a><ul></ul></li><li><a href=/docs/faq/>Frequently Asked Questions</a><ul></ul></li><li><span>Tools</span><ul><li><a href=/docs/tools/teddybench/>teddyBench</a><ul></ul></li><li><input type=checkbox id=section-a95e960a612f8fbab37aea668df2b6d5 class=toggle checked>
<label for=section-a95e960a612f8fbab37aea668df2b6d5 class="flex justify-between"><a href=/docs/tools/teddycloud/>teddyCloud</a></label><ul><li><input type=checkbox id=section-e3fdb821ecd591a792d8991d8793a35a class=toggle>
<label for=section-e3fdb821ecd591a792d8991d8793a35a class="flex justify-between"><a href=/docs/tools/teddycloud/usage/custom-tags/>Custom Tags</a></label></li><li><input type=checkbox id=section-9523e024da2d7ee74b826d07de2251dc class=toggle checked>
<label for=section-9523e024da2d7ee74b826d07de2251dc class="flex justify-between"><a href=/docs/tools/teddycloud/setup/>Setup</a></label><ul><li><input type=checkbox id=section-7133c53a2ea2209d7783202afb657f91 class=toggle>
<label for=section-7133c53a2ea2209d7783202afb657f91 class="flex justify-between"><a href=/docs/tools/teddycloud/setup/dump-certs/>Dump certificates</a></label><ul><li><a href=/docs/tools/teddycloud/setup/dump-certs/cc3200/>CC3200</a></li><li><a href=/docs/tools/teddycloud/setup/dump-certs/cc3235/>CC3235</a></li><li><a href=/docs/tools/teddycloud/setup/dump-certs/esp32/>ESP32</a></li></ul></li><li><input type=checkbox id=section-11c7b98653ea035f089a56d7c6e35235 class=toggle>
<label for=section-11c7b98653ea035f089a56d7c6e35235 class="flex justify-between"><a href=/docs/tools/teddycloud/setup/flash-ca/>Flash replacement CA</a></label><ul><li><a href=/docs/tools/teddycloud/setup/flash-ca/cc3200/>CC3200</a></li><li><a href=/docs/tools/teddycloud/setup/flash-ca/cc3235/>CC3235</a></li><li><a href=/docs/tools/teddycloud/setup/flash-ca/esp32/>ESP32</a></li></ul></li><li><input type=checkbox id=section-94896593d2bbd10884321ac3a1d237a1 class=toggle>
<label for=section-94896593d2bbd10884321ac3a1d237a1 class="flex justify-between"><a href=/docs/tools/teddycloud/setup/dns/>DNS</a></label><ul><li><a href=/docs/tools/teddycloud/setup/dns/cc3200/>CC3200</a></li><li><a href=/docs/tools/teddycloud/setup/dns/cc3235/>CC3235</a></li><li><a href=/docs/tools/teddycloud/setup/dns/esp32/>ESP32</a></li></ul></li><li><input type=checkbox id=section-87ae8ba146e78bcefd62407b91e1c638 class=toggle>
<label for=section-87ae8ba146e78bcefd62407b91e1c638 class="flex justify-between"><a href=/docs/tools/teddycloud/setup/error-codes/>Error codes</a></label></li><li><input type=checkbox id=section-0146e7f6eb9ff74d170906a54941d7a0 class=toggle>
<label for=section-0146e7f6eb9ff74d170906a54941d7a0 class="flex justify-between"><a href=/docs/tools/teddycloud/setup/supported-server-hardware/>Supported NAS/Server hardware</a></label></li><li><input type=checkbox id=section-b0544fbca97b173f472deb52fd233835 class=toggle checked>
<label for=section-b0544fbca97b173f472deb52fd233835 class="flex justify-between"><a href=/docs/tools/teddycloud/setup/test-troubleshooting/ class=active>Test & Troubleshooting</a></label></li></ul></li><li><input type=checkbox id=section-62746cc9c650d56f5986fdf1c6d399ee class=toggle>
<label for=section-62746cc9c650d56f5986fdf1c6d399ee class="flex justify-between"><a role=button>Technical Docs</a></label><ul><li><input type=checkbox id=section-1b26af4095794de335a4266f5f0d1fd7 class=toggle>
<label for=section-1b26af4095794de335a4266f5f0d1fd7 class="flex justify-between"><a href=/docs/tools/teddycloud/tecdoc/content-json/>content-json config</a></label></li><li><input type=checkbox id=section-919aea1bc5b4ca1dc4c6cb818efed4e4 class=toggle>
<label for=section-919aea1bc5b4ca1dc4c6cb818efed4e4 class="flex justify-between"><a href=/docs/tools/teddycloud/tecdoc/edit-local/>Edit JSON files with vscode</a></label></li><li><input type=checkbox id=section-f7171afa2b947249eea094548419c731 class=toggle>
<label for=section-f7171afa2b947249eea094548419c731 class="flex justify-between"><a href=/docs/tools/teddycloud/tecdoc/playlist-tap-json/>Playlists (TAP)</a></label></li><li><input type=checkbox id=section-de6f1b9043bddb49f7343761ffc28fdf class=toggle>
<label for=section-de6f1b9043bddb49f7343761ffc28fdf class="flex justify-between"><a href=/docs/tools/teddycloud/tecdoc/toniesboxes-custom-json/>tonieboxes-custom-json</a></label></li><li><input type=checkbox id=section-b359222ea3151b774d472f2c756be4ec class=toggle>
<label for=section-b359222ea3151b774d472f2c756be4ec class="flex justify-between"><a href=/docs/tools/teddycloud/tecdoc/tonies-custom-json/>tonies.custom.json config</a></label></li></ul></li></ul></li></ul></li><li><span>Box Variants</span><ul><li><a href=/docs/box-variants/esp32/>ESP32</a></li></ul></li><li><span>Custom Firmware</span><ul><li><input type=checkbox id=section-42e43c8e420eed49ce3d0915aa7a0f11 class=toggle>
<label for=section-42e43c8e420eed49ce3d0915aa7a0f11 class="flex justify-between"><a role=button>CC3200</a></label><ul><li><input type=checkbox id=section-fb4cb61a40d81e2312fca285b90fac32 class=toggle>
<label for=section-fb4cb61a40d81e2312fca285b90fac32 class="flex justify-between"><a href=/docs/custom-firmware/cc3200/hackieboxng-bl/>HackieboxNG Bootloader</a></label><ul><li><a href=/docs/custom-firmware/cc3200/hackieboxng-bl/install/>Installation</a></li><li><a href=/docs/custom-firmware/cc3200/hackieboxng-bl/bootloader/>Bootloader</a></li><li><a href=/docs/custom-firmware/cc3200/hackieboxng-bl/ofw-patches/>Firmware patches</a></li></ul></li><li><input type=checkbox id=section-e6b6fb6492df9b2143f091c829117a9d class=toggle>
<label for=section-e6b6fb6492df9b2143f091c829117a9d class="flex justify-between"><a href=/docs/custom-firmware/cc3200/hackiebox-cfw/>Hackiebox CFW PoC</a></label><ul><li><a href=/docs/custom-firmware/cc3200/hackiebox-cfw/api/>Hackiebox API</a></li></ul></li></ul></li><li><input type=checkbox id=section-96fc9f3b17ed6977851c210f7d13b6ef class=toggle>
<label for=section-96fc9f3b17ed6977851c210f7d13b6ef class="flex justify-between"><a role=button>ESP32</a></label><ul><li><a href=/docs/custom-firmware/esp32/teddybox/>TeddyBox CFW</a><ul></ul></li></ul></li></ul></li><li><a href=/docs/wiki/>Wiki</a><ul><li><input type=checkbox id=section-d8f00f9faa706cfd8232ca710ec83905 class=toggle>
<label for=section-d8f00f9faa706cfd8232ca710ec83905 class="flex justify-between"><a role=button>CC3200</a></label><ul><li><a href=/docs/wiki/cc3200/boot-process/>Boot Process</a></li><li><a href=/docs/wiki/cc3200/debug-port/>Debug port</a></li><li><a href=/docs/wiki/cc3200/firmware-layout/>Firmware layout</a></li><li><a href=/docs/wiki/cc3200/firmware-list/>Firmware list</a></li><li><a href=/docs/wiki/cc3200/hardware/>Hardware</a></li><li><a href=/docs/wiki/cc3200/microsd-compatibility/>microSD compatibility</a></li><li><a href=/docs/wiki/cc3200/pinout/>Pinout</a></li></ul></li><li><input type=checkbox id=section-67f43499674643a099dd84c6cb56579b class=toggle>
<label for=section-67f43499674643a099dd84c6cb56579b class="flex justify-between"><a role=button>ESP32</a></label><ul><li><a href=/docs/wiki/esp32/pinout/>Pinout</a></li></ul></li><li><input type=checkbox id=section-682231c8b0ba39c29d77ab65a2a7a682 class=toggle>
<label for=section-682231c8b0ba39c29d77ab65a2a7a682 class="flex justify-between"><a role=button>General</a></label><ul><li><a href=/docs/wiki/general/glossary/>Glossary</a></li><li><a href=/docs/wiki/general/audio-file-format/>Audio file format</a></li><li><a href=/docs/wiki/general/battery-power-supply/>Battery & Power supply</a></li><li><a href=/docs/wiki/general/internal-audio-files/>Internal audio files</a></li><li><a href=/docs/wiki/general/known-problems/>Known problems</a></li><li><a href=/docs/wiki/general/protocol-analysis/>Protocol analysis</a></li><li><a href=/docs/wiki/general/replacement-parts/>Replacement parts</a></li><li><a href=/docs/wiki/general/traffic-sniffing/>Traffic sniffing</a></li><li><a href=/docs/wiki/general/useful-links/>Useful links</a></li></ul></li><li><input type=checkbox id=section-208ce0560e3e7d166dff7af7bf56d73e class=toggle>
<label for=section-208ce0560e3e7d166dff7af7bf56d73e class="flex justify-between"><a role=button>Toniebox 2</a></label><ul><li><a href=/docs/wiki/tb2-v1/hardware/>Hardware</a></li><li><a href=/docs/wiki/tb2-v1/pinout/>Pinout</a></li></ul></li></ul></li></ul><ul><li><a href target=_blank rel=noopener>More</a><ul><li><a href=https://github.com/toniebox-reverse-engineering target=_blank rel=noopener>GitHub</a></li><li><a href=https://t.me/toniebox_reverse_engineering target=_blank rel=noopener>Telegram Chat</a></li><li><a href=https://forum.revvox.de/ target=_blank rel=noopener>Discourse Forum</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Test & Troubleshooting</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#connection-toniebox-to-teddycloud>Connection toniebox to teddyCloud</a><ul><li><a href=#error-codeword-turtle-schildkröte>Error: Codeword turtle (Schildkröte)</a></li><li><a href=#error-codeword-owl-eule>Error: Codeword owl (Eule)</a></li></ul></li><li><a href=#connection-teddycloud-to-boxine-cloud>Connection teddyCloud to boxine cloud</a><ul><li><a href=#log-is-fine>Log is fine</a></li><li><a href=#error-case---missing-client-certificates>Error case - Missing client certificates</a></li><li><a href=#error-case---proddetbstoys-is-resolved-to-teddycloud>Error case - prod.de.tbs.toys is resolved to teddyCloud</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=teddycloud---test--troubleshooting>teddyCloud - Test & Troubleshooting
<a class=anchor href=#teddycloud---test--troubleshooting>#</a></h1><h2 id=connection-toniebox-to-teddycloud>Connection toniebox to teddyCloud
<a class=anchor href=#connection-toniebox-to-teddycloud>#</a></h2><p>First of all please be sure the cloud is not enabled in the webinterface. Then close all browser windows to teddyClouds webinterface and open the logs of teddyCloud. If you are using docker you can access them via: <code>docker logs teddycloud</code>.</p><p>To be sure your toniebox can connect to teddyCloud we do a so called &ldquo;freshnessCheck&rdquo;. This can be initiated by pressing one ear of the box until the LED is pulsing blue.</p><h3 id=error-codeword-turtle-schildkröte>Error: Codeword turtle (Schildkröte)
<a class=anchor href=#error-codeword-turtle-schildkr%c3%b6te>#</a></h3><p>If the box is flashing red and shouts the codeword turtle, be sure teddyCloud is running and the box can connect to your cloud. Check the <a href=../dns>DNS step</a>.</p><h3 id=error-codeword-owl-eule>Error: Codeword owl (Eule)
<a class=anchor href=#error-codeword-owl-eule>#</a></h3><p>If the box is flashing red and shouts the codeword owl, be sure teddyClouds <code>certs/server/ca.der</code> is identical to the one on box. Please check the <a href=../flash-ca>Flash replacement CA step</a>.</p><p>Sometimes you&rsquo;ll need to regenerate teddyClouds certificates as it may be defective. For that delete all files in <code>certs/server/ca.der</code> and restart teddyCloud. We had the case that an esp32 based box worked with the certificate, but the cc3200 based one had trouble. After regenerating the certificates it was fine.</p><p>This error can also happen if the box tries to reach the boxine cloud. Check the <a href=../dns>DNS step</a>.</p><p>Alternativly you may use a reverse proxy like nginx or traefik between teddyCloud and your box. This is not supported, teddyCloud needs its own dedicated IP address.</p><p>Example log output:</p><pre tabindex=0><code>INFO |server.c:0574:server_init()| 1 open HTTPS connections
INFO |server.c:0574:server_init()| 0 open HTTPS connections
</code></pre><h2 id=connection-teddycloud-to-boxine-cloud>Connection teddyCloud to boxine cloud
<a class=anchor href=#connection-teddycloud-to-boxine-cloud>#</a></h2><p>Please visit <code>http://&lt;teddyCloud>/v1/time</code> and check the logs. You should see a number which is the current unixtime. The logs should look like that:</p><pre tabindex=0><code>INFO |handler_cloud.c:0038:handleCloudTime()|  &gt;&gt; respond with current time
INFO |mqtt.c:0684:mqtt_init_box()| Skipping client &#39;Toniebox&#39; (cn: &#39;default&#39;)
</code></pre><p>Please visit the webinterface and enable <code>Cloud enabled</code> and <code>Forward 'time</code>. Then visit <code>http://&lt;teddyCloud>/v1/time</code> again and check the logs. You should see the time again and following log:</p><h3 id=log-is-fine>Log is fine
<a class=anchor href=#log-is-fine>#</a></h3><pre tabindex=0><code>INFO |mqtt.c:0684:mqtt_init_box()| Skipping client &#39;Toniebox&#39; (cn: &#39;default&#39;)
INFO |cloud_request.c:0158:web_request()| Connecting to HTTP server prod.de.tbs.toys:443...
INFO |cloud_request.c:0208:web_request()|   trying IP: 18.156.186.144
INFO |cloud_request.c:0036:httpClientTlsInitCallbackBase()| Initializing TLS...
INFO |cloud_request.c:0071:httpClientTlsInitCallbackBase()| Initializing TLS done
INFO |cloud_request.c:0308:web_request()| HTTP code: 200
INFO |handler.c:0056:cbrCloudHeaderPassthrough()| &gt;&gt; cbrCloudHeaderPassthrough: Server = openresty
INFO |handler.c:0056:cbrCloudHeaderPassthrough()| &gt;&gt; cbrCloudHeaderPassthrough: Date = Sat, 26 Jan 2024 18:48:23 GMT
INFO |handler.c:0056:cbrCloudHeaderPassthrough()| &gt;&gt; cbrCloudHeaderPassthrough: Content-Type = text/plain; charset=utf-8
INFO |cloud_request.c:0339:web_request()| Content-Type is text/plain; charset=utf-8
INFO |handler.c:0056:cbrCloudHeaderPassthrough()| &gt;&gt; cbrCloudHeaderPassthrough: Content-Length = 10
[...]
INFO |handler.c:0061:cbrCloudHeaderPassthrough()| &gt;&gt; cbrCloudHeaderPassthrough: NULL
INFO |cloud_request.c:0386:web_request()| Response: &#39;1706384903&#39;
INFO |handler.c:0225:cbrCloudServerDiscoPassthrough()| &gt;&gt; cbrCloudServerDiscoPassthrough
INFO |cloud_request.c:0417:web_request()| Connection closed
</code></pre><h3 id=error-case---missing-client-certificates>Error case - Missing client certificates
<a class=anchor href=#error-case---missing-client-certificates>#</a></h3><pre tabindex=0><code>INFO |handler_cloud.c:0038:handleCloudTime()|  &gt;&gt; respond with current time
INFO |mqtt.c:0684:mqtt_init_box()| Skipping client &#39;Toniebox&#39; (cn: &#39;default&#39;)
INFO |cloud_request.c:0158:web_request()| Connecting to HTTP server prod.de.tbs.toys:443...
INFO |cloud_request.c:0208:web_request()|   trying IP: 3.69.182.181
INFO |cloud_request.c:0036:httpClientTlsInitCallbackBase()| Initializing TLS...
ERROR|cloud_request.c:0218:web_request()| Failed to connect to HTTP server! Error=2
</code></pre><p>Please check your client certificates from the <a href=../dump-certs>dump CA and client certificates step</a>.</p><h3 id=error-case---proddetbstoys-is-resolved-to-teddycloud>Error case - prod.de.tbs.toys is resolved to teddyCloud
<a class=anchor href=#error-case---proddetbstoys-is-resolved-to-teddycloud>#</a></h3><pre tabindex=0><code>INFO |cloud_request.c:0158:web_request| Connecting to HTTP server prod.de.tbs.toys:443...
INFO |cloud_request.c:0208:web_request|   trying IP: 192.168.xxx.xxx
INFO |cloud_request.c:0036:httpClientTlsInitCallbackBase| Initializing TLS...
INFO |cloud_request.c:0071:httpClientTlsInitCallbackBase| Initializing TLS done
ERROR|cloud_request.c:0218:web_request| Failed to connect to HTTP server! Error=537
INFO |handler_cloud.c:0692:handleCloudFreshnessCheck| Freshness check response: size=14, content=
WARN |tls_server_fsm.c:0260:tlsPerformServerHandshake| TLS handshake failure!
</code></pre><p>Please check if <code>prod.de.tbs.toys</code> and <code>rtnl.bxcl.de</code> are resolved to your teddyCloud instance within its own container. Please either give your Toniebox a custom DNS that resolved them to teddyCloud or the teddyCloud instance a DNS that does not tamper the urls.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/toniebox-reverse-engineering/toniebox-reverse-engineering.github.io/commit/5ab1565c44b8b85b6854fffa7f2fdce2bc746ae3 title='Last modified by Adrianus Kleemans | 2024-10-10' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>2024-10-10</span></a></div><div><a class="flex align-center" href=https://github.com/toniebox-reverse-engineering/toniebox-reverse-engineering.github.io/edit/master/content/docs/tools/teddyCloud/setup/test-troubleshooting.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#connection-toniebox-to-teddycloud>Connection toniebox to teddyCloud</a><ul><li><a href=#error-codeword-turtle-schildkröte>Error: Codeword turtle (Schildkröte)</a></li><li><a href=#error-codeword-owl-eule>Error: Codeword owl (Eule)</a></li></ul></li><li><a href=#connection-teddycloud-to-boxine-cloud>Connection teddyCloud to boxine cloud</a><ul><li><a href=#log-is-fine>Log is fine</a></li><li><a href=#error-case---missing-client-certificates>Error case - Missing client certificates</a></li><li><a href=#error-case---proddetbstoys-is-resolved-to-teddycloud>Error case - prod.de.tbs.toys is resolved to teddyCloud</a></li></ul></li></ul></nav></div></aside></main></body></html>